var advices = [{ "ElementName": "Азот (N)", "PlantName": "Диня", "ImageName": "диня.jpg" }, { "ElementName": "Азот (N)", "PlantName": "Кавун", "ImageName": "кавун.jpg" }, { "ElementName": "Азот (N)", "PlantName": "Ячмінь", "ImageName": "ячмінь.jpg" }, { "ElementName": "Фосфор (P)", "PlantName": "Капуста", "ImageName": "капуста.jpg" }, { "ElementName": "Фосфор (P)", "PlantName": "Огірки", "ImageName": "огірки.jpeg" }, { "ElementName": "Фосфор (P)", "PlantName": "Пізня морква", "ImageName": "пізня морква.jpg" }, { "ElementName": "Фосфор (P)", "PlantName": "Ревінь", "ImageName": "ревінь.jpg" }, { "ElementName": "Фосфор (P)", "PlantName": "Селера", "ImageName": "селера.jpg" }, { "ElementName": "Фосфор (P)", "PlantName": "Тиква", "ImageName": "тиква.jpg" }, { "ElementName": "Калій (К)", "PlantName": "Картопля", "ImageName": "картопля.jpg" }, { "ElementName": "Калій (К)", "PlantName": "Капуста", "ImageName": "капуста.jpg" }, { "ElementName": "Калій (К)", "PlantName": "Огірки", "ImageName": "огірки.jpeg" }, { "ElementName": "Калій (К)", "PlantName": "Пізня морква", "ImageName": "пізня морква.jpg" }, { "ElementName": "Калій (К)", "PlantName": "Помідори", "ImageName": "помідори.jpg" }, { "ElementName": "Калій (К)", "PlantName": "Ревінь", "ImageName": "ревінь.jpg" }, { "ElementName": "Калій (К)", "PlantName": "Селера", "ImageName": "селера.jpg" }, { "ElementName": "Калій (К)", "PlantName": "Тиква", "ImageName": "тиква.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Картопля", "ImageName": "картопля.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Буряк", "ImageName": "буряк.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Вишня", "ImageName": "вишня.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Горох", "ImageName": "горох.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Груша", "ImageName": "груша.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Капуста", "ImageName": "капуста.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Коренеплоди", "ImageName": "коренеплоди.jpeg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Малина", "ImageName": "малина.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Овес", "ImageName": "овес.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Помідори", "ImageName": "помідори.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Редис", "ImageName": "редис.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Тонконогові", "ImageName": "тонконогові.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Черешня", "ImageName": "черешня.jpg" }, { "ElementName": "Марганець (Mn)", "PlantName": "Яблука", "ImageName": "яблука.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Сорго", "ImageName": "сорго.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Горох", "ImageName": "горох.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Гречка", "ImageName": "гречка.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Жито", "ImageName": "жито.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Квасоля", "ImageName": "квасоля.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Кукурудза", "ImageName": "кукурудза.jpeg" }, { "ElementName": "Сірка (S)", "PlantName": "Овес", "ImageName": "овес.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Просо", "ImageName": "просо.jpeg" }, { "ElementName": "Сірка (S)", "PlantName": "Пшениця", "ImageName": "пшениця.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Рис", "ImageName": "рис.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Ріпак", "ImageName": "ріпак.png" }, { "ElementName": "Сірка (S)", "PlantName": "Соняшник", "ImageName": "соняшник.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Сочевиця", "ImageName": "сочевиця.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Соя", "ImageName": "соя.jpg" }, { "ElementName": "Сірка (S)", "PlantName": "Ячмінь", "ImageName": "ячмінь.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Картопля", "ImageName": "картопля.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Буряк", "ImageName": "буряк.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Виноград", "ImageName": "виноград.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Гречка", "ImageName": "гречка.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Груша", "ImageName": "груша.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Клевер", "ImageName": "клевер.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Кукурудза", "ImageName": "кукурудза.jpeg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Льон", "ImageName": "льон.jpg" }, { "ElementName": "Цинк (Zn)", "PlantName": "Хмель", "ImageName": "хмель.png" }, { "ElementName": "Цинк (Zn)", "PlantName": "Яблука", "ImageName": "яблука.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Буряк", "ImageName": "буряк.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Капуста", "ImageName": "капуста.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Кукурудза", "ImageName": "кукурудза.jpeg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Льон", "ImageName": "льон.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Люцерна", "ImageName": "люцерна.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Овес", "ImageName": "овес.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Пізня морква", "ImageName": "пізня морква.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Пшениця", "ImageName": "пшениця.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Цибуля", "ImageName": "цибуля.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Шпинат", "ImageName": "шпинат.jpg" }, { "ElementName": "Мідь (Cu)", "PlantName": "Ячмінь", "ImageName": "ячмінь.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Сорго", "ImageName": "сорго.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Картопля", "ImageName": "картопля.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Горох", "ImageName": "горох.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Боби", "ImageName": "боби.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Гречка", "ImageName": "гречка.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Жито", "ImageName": "жито.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Капуста", "ImageName": "капуста.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Квасоля", "ImageName": "квасоля.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Коренеплоди", "ImageName": "коренеплоди.jpeg" }, { "ElementName": "Бор (B)", "PlantName": "Кукурудза", "ImageName": "кукурудза.jpeg" }, { "ElementName": "Бор (B)", "PlantName": "Льон", "ImageName": "льон.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Овес", "ImageName": "овес.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Огірки", "ImageName": "огірки.jpeg" }, { "ElementName": "Бор (B)", "PlantName": "Перець", "ImageName": "перець.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Пізня морква", "ImageName": "пізня морква.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Помідори", "ImageName": "помідори.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Просо", "ImageName": "просо.jpeg" }, { "ElementName": "Бор (B)", "PlantName": "Пшениця", "ImageName": "пшениця.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Рис", "ImageName": "рис.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Ріпак", "ImageName": "ріпак.png" }, { "ElementName": "Бор (B)", "PlantName": "Соняшник", "ImageName": "соняшник.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Сочевиця", "ImageName": "сочевиця.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Соя", "ImageName": "соя.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Цибуля", "ImageName": "цибуля.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Конопля", "ImageName": "конопля.jpg" }, { "ElementName": "Бор (B)", "PlantName": "Ячмінь", "ImageName": "ячмінь.jpg" }];
var symptomps = [{ "ElementName": "Азот (N)", "IsForDeficit": false, "Description": "Коренеплоди переростають в бадилля, злакові вилягають, в коренеплодах знижується вміст цукрів, в картоплі крохмалю, в овочевих і баштанних культурах накопичуються нітрати" }, { "ElementName": "Азот (N)", "IsForDeficit": true, "Description": "Послаблюється ріст бічних пагонів. Листки, стебла і плоди зменшуються в розмірі, листки стають блідо-зеленими або жовтуватими. При тривалому недоліку блідо-зелений колір листя стає помаранчевим і червоним, листя висихають і передчасно обпадають, що обмежує утворення плодів, знижує урожай і погіршує його якість" }, { "ElementName": "Фосфор (P)", "IsForDeficit": false, "Description": "Сповільнюється розвиток рослин і їх дозрівання, знижується урожай і його якість. Листя стають спочатку по краях, а потім по всій поверхні сіро-зеленими або червоно-фіолетовий. У плодових культур пагони стають тонкими, листя набувають бронзовий відтінок і передчасно обпадають" }, { "ElementName": "Фосфор (P)", "IsForDeficit": true, "Description": "Негативно впливає на, доступність заліза, цинку та інших мікроелементів" }, { "ElementName": "Калій (К)", "IsForDeficit": false, "Description": "Краї листків буріють, набуваючи обпаленого вигляду, на пластинках з`являються дрібні іржаві точки, листок стає гофрованим або куполоподібна закручений-ним, на листках картоплі утворюється характерний бронзовий наліт" }, { "ElementName": "Калій (К)", "IsForDeficit": true, "Description": "У рослин утворюються укорочені квітконоси, старе листя швидко жовтіють, погіршується колір квіток. | Погіршуються засвоєння магнію і кальцію" }, { "ElementName": "Марганець (Mn)", "IsForDeficit": false, "Description": "Порушується співвідношення елементів мінерального живлення в поживному балансі. Характерним симптомом такого порушення є точковий хлороз листя, у злакових з`являється `сіра плямистість`, у столових, цукрових і кормових буряків і шпинаті `плямиста жовтуха`, у гороху `болотна плямистість`, у плодових хлороз старих листків, особливо сильний в груші і вишні" }, { "ElementName": "Марганець (Mn)", "IsForDeficit": true, "Description": "У клітинах рослини зменшується вміст хлорофілу, тому симптоми такі ж, як і при дефіциті магнію: починається межжілковий хлороз, з`являються бурі некротичні плями, листя зморщується і обпадають" }, { "ElementName": "Сірка (S)", "IsForDeficit": false, "Description": "Пригнічується фотосинтез і виникає хлороз листя. За загальними ознаками схоже на прояв дефіциту азоту: молоде листя рівномірно жовтіють, а жилки набувають пурпурний відтінок. Поступово втрачають колір і старі листки" }, { "ElementName": "Сірка (S)", "IsForDeficit": true, "Description": "Листя поступово жовтіють по краях і загортаються всередину. Потім буріють і відмирають" }, { "ElementName": "Цинк (Zn)", "IsForDeficit": false, "Description": "Затримується утворення сахарози. крохмалю та ауксинов, порушується утворення білків, у результаті чого в них накопичуються небілкові сполуки азоту і порушується фото- синтез. Пригнічується процес ділення клітин, в результаті чого деформуються і зменшуються листки, пригнічується ріст рослини. У кукурудзи відзначається обілення або хлороз верхніх листків, у томатів скручування листя і черешків" }, { "ElementName": "Цинк (Zn)", "IsForDeficit": true, "Description": "На нижніх листках рослини, уздовж головної жилки, з`являються водяні прозорі плями. Через деякий час, виявляється некроз, і листя опадає" }, { "ElementName": "Мідь (Cu)", "IsForDeficit": false, "Description": "Затримується ріст і цвітіння, з`являється хлороз листків, втрата тургору клітин і в`янення рослин. При гострому дефіциті міді у злакових рослин відзначається обілення кінчиків листя, недорозвинення колоса, надлишкова кущистість (у вівса ячменю, буряків, цибулі і бобових), у плодових \"суховершинность\" і невластивий в цей період, зростання бічних\r\nпагонів" }, { "ElementName": "Мідь (Cu)", "IsForDeficit": true, "Description": "Обмежує надходження заліза в рослину" }, { "ElementName": "Бор (B)", "IsForDeficit": false, "Description": "Порушується синтез, перетворення і переміщення вуглеводів, формування репродуктивних органів, запліднення (стерильність) і плодоношення рослин. У плодових спостерігається скручування і опадання верхніх листків. Іноді на плодах проявляються (всередині і на поверхні) водянисті виразки, які потім буріють і тверднуть, при цьому плоди набувають характерного гіркуватого присмаку. Підвищується ураження грибковими, бактеріальними і вірусними захворюваннями" }, { "ElementName": "Бор (B)", "IsForDeficit": true, "Description": "Краї нижнього листя набувають коричневий колір. Потім між жилками з`являються коричневі плями і листя опадає" }];
//var desrp = [{ elementName: , lack: , excess: }];

(function() {
    $(window).on("load", function() {
        function getOptimalDataArr() {
            this.data = [{
                nameElem: "Азот (N)",
                badRanges: [{ b: 0, e: 100 }],
                averageRanges: [{ b: 101, e: 199 }],
                optimalRange: { b: 200, e: 400 },
            }, {
                nameElem: "pH грунту",
                badRanges: [{ b: 0, e: 4.1 }, { b: 8.5, e: 18 }],
                averageRanges: [{ b: 4.2, e: 5.5 }, { b: 7.1, e: 8.4 }],
                optimalRange: { b: 5.6, e: 7.0 },
            }, {
                nameElem: "Фосфор (P)",
                badRanges: [{ b: 0, e: 41 }],
                averageRanges: [{ b: 42, e: 249 }],
                optimalRange: { b: 250, e: 500 },
            }, {
                nameElem: "Калій (К)",
                badRanges: [{ b: 0, e: 41 }],
                averageRanges: [{ b: 42, e: 249 }],
                optimalRange: { b: 250, e: 500 },
            }, {
                nameElem: "Марганець (Mn)",
                badRanges: [{ b: 0, e: 5 }],
                averageRanges: [{ b: 5.1, e: 10 }],
                optimalRange: { b: 10, e: 20 },
            }, {
                nameElem: "Цинк (Zn)",
                badRanges: [{ b: 0, e: 1 }, { b: 49, e: 100 }],
                averageRanges: [{ b: 24, e: 48 }],
                optimalRange: { b: 1.1, e: 23 },
            }, {
                nameElem: "Мідь (Cu)",
                badRanges: [{ b: 0, e: 0.11 }, { b: 8, e: 19 }],
                averageRanges: [{ b: 0.12, e: 0.4 }, { b: 4, e: 8 }],
                optimalRange: { b: 0.5, e: 3 },
            }, {
                nameElem: "Бор (B)",
                badRanges: [{ b: 0, e: 0.15 }],
                averageRanges: [{ b: 0.16, e: 0.32 }],
                optimalRange: { b: 0.33, e: 0.66 },
            }, {
                nameElem: "Кобальт (Co)",
                badRanges: [{ b: 0, e: 0.07 }, { b: 11, e: 22 }],
                averageRanges: [{ b: 0.08, e: 0.15 }, { b: 5.1, e: 10.0 }],
                optimalRange: { b: 0.16, e: 5.0 },
            }, {
                nameElem: "Кадмій (Cd)",
                badRanges: [{ b: 0, e: 0.10 }, { b: 0.71, e: 1.5 }],
                averageRanges: [{ b: 0.35, e: 0.70 }],
                optimalRange: { b: 0.11, e: 0.34 },
            }, {
                nameElem: "Свинець (Pb)",
                badRanges: [{ b: 0, e: 0.80 }, { b: 7, e: 14 }],
                averageRanges: [{ b: 2.86, e: 6 }],
                optimalRange: { b: 0.81, e: 2.85 },
            }, {
                nameElem: "Ртуть (Hg)",
                badRanges: [{ b: 0, e: 0.99 }, { b: 2.11, e: 5 }],
                averageRanges: [{ b: 1, e: 2.1 }],
                optimalRange: { b: 0.01, e: 0.9 },
            }, {
                nameElem: "Цезій (Cs)",
                badRanges: [{ b: 556, e: 1000 }],
                averageRanges: [{ b: 38, e: 555 }],
                optimalRange: { b: 0, e: 37 },
            }, {
                nameElem: "Стронцій (Sr)",
                badRanges: [{ b: 111, e: 222 }],
                averageRanges: [{ b: 0.38, e: 110 }],
                optimalRange: { b: 0, e: 0.37 },
            }, {
                nameElem: "Органічна речовина",
                badRanges: [{ b: 0, e: 1.1 }, { b: 11, e: 22 }],
                averageRanges: [{ b: 1.2, e: 4 }, { b: 5.1, e: 10 }],
                optimalRange: { b: 4.1, e: 5 },
            }, {
                nameElem: "Сірка (S)",
                badRanges: [{ b: 0, e: 3 }, { b: 25, e: 50 }],
                averageRanges: [{ b: 4, e: 8 }, { b: 16, e: 25 }],
                optimalRange: { b: 9, e: 15 },
            }, {
                nameElem: "Агрохімічна оцінка",
                badRanges: [{ b: 0, e: 33 }],
                averageRanges: [{ b: 34, e: 66 }],
                optimalRange: { b: 67, e: 100 },
            }, {
                nameElem: "Еколого-агрохімічна оцінка",
                badRanges: [{ b: 0, e: 33 }],
                averageRanges: [{ b: 34, e: 66 }],
                optimalRange: { b: 67, e: 100 },
            }];
            return this.data;
        }

        function setProgressBarsProgress() {

            console.log(getOptimalDataArr());
            var tableAnalyseTrs = $("#analyse > table > tbody > tr");

            for (var i = 0; i < tableAnalyseTrs.length; i++) {
                var nameOfComponent = $($(tableAnalyseTrs[i]).children("td")[0]).text();
                var valueOfComponent = $($(tableAnalyseTrs[i]).children("td")[1]).text();


                var progressBarConfig = getProgressBarConfiguration(nameOfComponent, valueOfComponent);
                var elem = $($(tableAnalyseTrs[i]).children("td")[3]).children(".progress").children(".progress-bar");
                $($(tableAnalyseTrs[i]).children("td")[3]).children(".progress").children(".progress-bar").css("background-color", progressBarConfig.color);
                move(elem, progressBarConfig.percent);
                //console.log($($(tableAnalyseTrs[0/*i*/]).children("td")[3]).children(".progress").children(".progress-bar").css("background-color"));
            }
        };

        $(document).keyup(function(e) {
             if (e.keyCode == 27) { // escape key maps to keycode `27`
                $(".description").hide();
            }
        });

        function move(elem, widthFull) {
            //console.log(elem);
            var width = 0;
            var step = widthFull / 5;
            var id = setInterval(frame, 50);

            function frame() {
                if (width >= widthFull) {
                    clearInterval(id);
                } else {
                    width += step;
                    $(elem).css("width", width + "%");
                }
            }
        }

        function getOptimalDataAboutElemntByName(name) {
            var optimalDataArr = getOptimalDataArr();

            for (var i = 0; i < optimalDataArr.length; i++) {
                if (optimalDataArr[i].nameElem == name) {
                    return optimalDataArr[i];
                }
            }
            return {};
        }

        function calculateOnePercent(beginInterval, endInterval) {
            return (endInterval - beginInterval) / 100;
        }

        function getProgressBarConfiguration(nameOfComponent, valueOfComponent) {
            var optValForCurrentElem = getOptimalDataAboutElemntByName(nameOfComponent);

            if (isInOptimalRange(optValForCurrentElem, valueOfComponent)) {
                var onePecent = calculateOnePercent(optValForCurrentElem.optimalRange.b, optValForCurrentElem.optimalRange.e);
                var totalPercents = ((valueOfComponent - optValForCurrentElem.optimalRange.b) / onePecent) * 0.33 + 66;
                return { color: "lightgreen", percent: totalPercents };
            }

            if (!hasOneAverageAndBadRange(optValForCurrentElem)) {
                if (isInAverageRange(optValForCurrentElem, valueOfComponent)) {
                    var onePecent = calculateOnePercent(optValForCurrentElem.averageRanges[0].b, optValForCurrentElem.averageRanges[0].e);
                    var totalPercents = ((valueOfComponent - optValForCurrentElem.averageRanges[0].b) / onePecent) * 0.33 + 33;
                    return { color: "yellow", percent: totalPercents };
                }
                if (isInBadRange(optValForCurrentElem, valueOfComponent)) {
                    var onePecent = calculateOnePercent(optValForCurrentElem.badRanges[0].b, optValForCurrentElem.badRanges[0].e);
                    var totalPercentsInRange = ((valueOfComponent - optValForCurrentElem.badRanges[0].b) / onePecent) * 0.33;
                    return { color: "red", percent: totalPercentsInRange };
                }
            } else {
                if (isInAverageRangeBelowOptimal(optValForCurrentElem, valueOfComponent)) {
                    var onePecent = calculateOnePercent(optValForCurrentElem.averageRanges[0].b, optValForCurrentElem.averageRanges[0].e);
                    var totalPercents = ((valueOfComponent - optValForCurrentElem.averageRanges[0].b) / onePecent) * 0.33 + 33;
                    return { color: "yellow", percent: totalPercents };
                }
                if (isInAverageRangeAboveOptimal(optValForCurrentElem, valueOfComponent)) {
                    var onePecent = calculateOnePercent(optValForCurrentElem.averageRanges[1].b, optValForCurrentElem.averageRanges[1].e);
                    var totalPercents = ((valueOfComponent - optValForCurrentElem.averageRanges[1].b) / onePecent) * 0.33 + 33;
                    return { color: "yellow", percent: totalPercents };
                }
                if (isInBadRangeBelowOptimal(optValForCurrentElem, valueOfComponent)) {
                    var onePecent = calculateOnePercent(optValForCurrentElem.badRanges[0].b, optValForCurrentElem.badRanges[0].e);
                    var totalPercents = ((valueOfComponent - optValForCurrentElem.badRanges[0].b) / onePecent) * 0.33;
                    return { color: "red", percent: totalPercents };
                }
                if (isInBadRangeAboveOptimal(optValForCurrentElem, valueOfComponent)) {
                    var onePecent = calculateOnePercent(optValForCurrentElem.badRanges[1].b, optValForCurrentElem.badRanges[1].e);
                    var totalPercents = ((valueOfComponent - optValForCurrentElem.badRanges[1].b) / onePecent) * 0.33;
                    return { color: "red", percent: totalPercents };
                }
            }
        }

        function hasOneAverageAndBadRange(optValForCurrentElem) {
            if (optValForCurrentElem.averageRanges.length > 1) {
                return true;
            }
            return false;
        }

        function isInOptimalRange(optValForCurrentElem, valueOfComponent) {
            if (optValForCurrentElem.optimalRange.b <= valueOfComponent && optValForCurrentElem.optimalRange.e >= valueOfComponent) {
                return true;
            }
            return false;
        }

        function isInAverageRangeBelowOptimal(optValForCurrentElem, valueOfComponent) {
            if (optValForCurrentElem.averageRanges[0].b <= valueOfComponent && optValForCurrentElem.averageRanges[0].e >= valueOfComponent) {
                return true;
            }
            return false;
        }

        function isInAverageRangeAboveOptimal(optValForCurrentElem, valueOfComponent) {
            if (optValForCurrentElem.averageRanges[1].b <= valueOfComponent && optValForCurrentElem.averageRanges[1].e >= valueOfComponent) {
                return true;
            }
            return false;
        }

        function isInBadRangeBelowOptimal(optValForCurrentElem, valueOfComponent) {
            if (optValForCurrentElem.badRanges[0].b <= valueOfComponent && optValForCurrentElem.badRanges[0].e >= valueOfComponent) {
                return true;
            }
            return false;
        }

        function isInBadRangeAboveOptimal(optValForCurrentElem, valueOfComponent) {
            if (optValForCurrentElem.badRanges[1].b <= valueOfComponent && optValForCurrentElem.badRanges[1].e >= valueOfComponent) {
                return true;
            }
            return false;
        }

        function isInAverageRange(optValForCurrentElem, valueOfComponent) {
            return isInAverageRangeBelowOptimal(optValForCurrentElem, valueOfComponent);
        }

        function isInBadRange(optValForCurrentElem, valueOfComponent) {
            if (optValForCurrentElem.badRanges[0].b <= valueOfComponent && optValForCurrentElem.badRanges[0].e >= valueOfComponent) {
                return true;
            }
            return false;
        }

        setProgressBarsProgress();

        $(".work-place .modal-body").mCustomScrollbar({
            theme: "minimal-dark"
        });

        $(".description .modal-body").mCustomScrollbar({
            theme: "minimal-dark" //,
        });

        $(".chem-elem-desc .modal-body").mCustomScrollbar({
            theme: "minimal-dark"
        });




        $(".indicators-list > ul li span").on("click", function() {
            var div = $(this).parent("li").children(".content");
            if ($(div).css("display") == "block") {
                $(div).fadeOut(200);
            } else {
                $(div).fadeIn(200);
            }
        });
        $(".indicators-list li ul i").on("click", function() {
            var div = $(this).parent("li").children(".content");
            if ($(div).css("display") == "block") {
                $(div).fadeOut(200);
            } else {
                $(div).fadeIn(200);
            }
        });

        $(".add-btn").on("click", function() {
            $("#fields").fadeOut(200);
            $("#input").fadeIn(200)
        });

        $(".search-category a").on("click", function() {

            $(".indicators-list > ul > div").hide();
            var classesNameOfCategoryItem = $(this).attr("class");
            if (classesNameOfCategoryItem != undefined) {
                var idOfBlockForShow = "#" + classesNameOfCategoryItem.replace("active", "").replace(".", "");
            }

            $(idOfBlockForShow).show();
            $(this).parent("li").parent("ul").find("a").removeClass("active");
            $(this).addClass("active");

        });

        $(".main-agro-indicators ul li > input").on("click", function() {
            $(".legend-tooltip").show();
            var tableLegendClassName = $(".main-agro-indicators input:checked").attr("class").split("-")[0] + "-legend";
            $(".legend-tooltip table").empty();
            var table = document.createElement("table");
            $(table).append($("." + tableLegendClassName).html());
            $(".legend-tooltip table").append(table);
        });

        $("#close-tooltip-btn").on("click", function() {
            $(".legend-tooltip").hide();
        });

        $("#description-btn").on("click", function() {
            $(".description").show();
        })

        function getBiggerDecription() {
            var tableAnalyseTrs = $("#analyse > table > tbody > tr");

            for (var i = 0; i < tableAnalyseTrs.length; i++) {
                var nameOfComponent = $($(tableAnalyseTrs[i]).children("td")[0]).text();
                var valueOfComponent = $($(tableAnalyseTrs[i]).children("td")[1]).text();


                var progressBarConfig = getProgressBarConfiguration(nameOfComponent, valueOfComponent);
                var elem = $($(tableAnalyseTrs[i]).children("td")[3]).children(".progress").children(".progress-bar");
                $($(tableAnalyseTrs[i]).children("td")[3]).children(".progress").children(".progress-bar").css("background-color", progressBarConfig.color);
                move(elem, progressBarConfig.percent);
                //console.log($($(tableAnalyseTrs[0/*i*/]).children("td")[3]).children(".progress").children(".progress-bar").css("background-color"));
            }
        };

        function containsObject(obj, list) {
            var i;
            for (i = 0; i < list.length; i++) {
                if (list[i].PlantName == obj.PlantName) {
                    return true;
                }
            }

            return false;
        }

        this.showDescriptionIfNotOptimal = function() {

        };

        this.echo = function() {
            var tableAnalyseTrs = $("#analyse > table > tbody > tr");
            var plantsToDisplay = [];
            var symptompsToShow = [];
            /*var h =

                $.ajax({
                    type: "GET",
                    dataType: "json",
                    url: "http://localhost:21502/Home/GetAdvices",
                    success: function(data) {
                        console.log(data.data);
                    },
                    error: function(data) {
                        alert('Some erorr occurs');
                    }
                });
*/
            for (var i = 0; i < tableAnalyseTrs.length; i++) {
                var nameOfComponent = $($(tableAnalyseTrs[i]).children("td")[0]).text();
                var valueOfComponent = $($(tableAnalyseTrs[i]).children("td")[1]).text();
                var optimalData = getOptimalDataAboutElemntByName(nameOfComponent);
                var symptompsToShow = symptomps.filter(function(item) {
                    return item.ElementName == nameOfComponent });
                console.log();


                if (isInOptimalRange(optimalData, valueOfComponent)) {
                    var plantsList = advices.filter(function(elem) {
                        return elem.ElementName == nameOfComponent
                    });

                    for (var j = 0; j < plantsList.length; j++) {

                        if (!containsObject(plantsList[j], plantsToDisplay) /*plantsToDisplay.indexOf(plantsList[j]) < 0*/ ) {
                            plantsToDisplay.push(plantsList[j]);
                        }
                    }
                } else {
                    var sympt = symptomps.filter(function(item) { return item.ElementName == nameOfComponent });
                    if (sympt.length) {
                        if (valueOfComponent > optimalData.optimalRange.e) {
                            $(".chem-elem-desc").append("<div class='panel panel-danger'><div class='panel-heading'>" + nameOfComponent + ". Вміст - " + valueOfComponent + " Оптимальні показники [" + optimalData.optimalRange.b + "-" + optimalData.optimalRange.e + "] </div><div class='panel-body'>" + sympt[0].Description + "</div></div>");
                        } else {
                            $(".chem-elem-desc").append("<div class='panel panel-warning'><div class='panel-heading'>" + nameOfComponent + ". Вміст - "+ valueOfComponent + " Оптимальні показники [" + optimalData.optimalRange.b + "-" + optimalData.optimalRange.e + "] </div><div class='panel-body'>" + sympt[1].Description + "</div></div>");
                        }
                    }
                }
            }

            for (var j = 0; j < plantsToDisplay.length; j++) {
                $(".grow-cultures-list.should").append("<div class='grow-cultures-list-item'><div class='list-item-img'><img src='../img/" + plantsToDisplay[j].ImageName + "'/></div><div class='list-item-title text-center'>" + plantsToDisplay[j].PlantName + "</div></div>");
            }
        }
        echo();
    });
})();



